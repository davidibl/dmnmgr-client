<xn-menu-header [brandName]="'dmnmgr'" [brandLogoSource]="'assets/logo.png'" (outsideClick)="onMenuOutsideClick()">
    <li class="menu">
        <xn-button (click)="menuVisible = !menuVisible"
                   (mouseenter)="openMenu('fileMenuVisible')"
                   [selected]="menuVisible && fileMenuVisible"
                   class="small transparent nounderline">
                   Projekt<ng-container *ngIf="hasChanges$ | async">*</ng-container>
            <ul *ngIf="menuVisible && fileMenuVisible" class="sub-menu">
                <div class="sub-menu-container">
                    <li (click)="createNewProject()">
                        <i class="fa fa-file-o mr-05" aria-hidden="true"></i>Neu
                        <span class="right">(STRG + N)</span>
                    </li>
                    <li (click)="openProject()">
                        <i class="fa fa-folder-open-o mr-05" aria-hidden="true"></i>Öffnen
                        <span class="right">(STRG + O)</span>
                    </li>
                    <li (click)="openFolder()">
                        <i class="fa fa-folder-open-o mr-05" aria-hidden="true"></i>Ordner öffnen
                        <span class="right">(STRG + P)</span>
                    </li>
                    <li class="section-divider"><xn-section-divider [lineOnly]="true"></xn-section-divider></li>
                    <li (click)="saveProject()">
                        <i class="fa fa-floppy-o mr-05" aria-hidden="true"></i>Speichern
                        <span class="right">(STRG + S)</span>
                    </li>
                    <li (click)="saveProjectAs()">Speichern unter</li>
                    <li class="section-divider"><xn-section-divider [lineOnly]="true"></xn-section-divider></li>
                    <li (click)="importExistingDmn()">
                        <i class="fa fa-upload mr-05" aria-hidden="true"></i>Dmn Datei importieren
                    </li>
                    <li class="section-divider"><xn-section-divider [lineOnly]="true"></xn-section-divider></li>
                    <li (mouseenter)="recentFilesMenuVisible = !recentFilesMenuVisible"
                        (mouseleave)="recentFilesMenuVisible = false">
                        <i class="fa fa-clock-o mr-05" aria-hidden="true"></i>Zuletzt geöffnet
                        <span class="right"><i class="fa fa-arrow-right mr-05" aria-hidden="true"></i></span>
                        <ul *ngIf="recentFilesMenuVisible" class="sub-sub-menu">
                            <div class="sub-menu-container">
                            <ng-container *ngIf="mostRecentFiles$ | async as mostRecentFiles">
                                <li *ngFor="let mostRecentFile of mostRecentFiles"
                                    (click)="openRecentFile(mostRecentFile.path)">
                                    {{mostRecentFile.name}}
                                </li>
                            </ng-container>
                            </div>
                        </ul>
                    </li>
                    <li class="section-divider"><xn-section-divider [lineOnly]="true"></xn-section-divider></li>
                    <li (click)="quit()">
                        <i class="fa fa-sign-out mr-05" aria-hidden="true"></i>Beenden
                    </li>
                </div>
            </ul>
        </xn-button>
    </li>
    <li class="menu">
        <xn-button (click)="menuVisible = !menuVisible"
                    (mouseenter)="openMenu('bearbeitenMenuVisible')"
                    [selected]="menuVisible && bearbeitenMenuVisible"
                    class="small transparent nounderline">Bearbeiten
            <ul *ngIf="menuVisible && bearbeitenMenuVisible" class="sub-menu">
                <div class="sub-menu-container">
                    <li (click)="openSearch()">
                        <i class="fa fa-search mr-05" aria-hidden="true"></i>Suchen
                        <span class="right">(STRG + F)</span>
                    </li>
                    <li *ngIf="isDecicionTableMode" (click)="exportCurrentTable()">
                        <i class="fa fa-exchange mr-05" aria-hidden="true"></i>CSV Exportieren
                        <span class="right">(STRG + E)</span>
                    </li>
                    <li *ngIf="isDecicionTableMode" (click)="importCsv()">
                        <i class="fa fa-cloud-upload mr-05" aria-hidden="true"></i>CSV Importieren
                        <span class="right">(STRG + I)</span>
                    </li>
                    <li class="section-divider"><xn-section-divider [lineOnly]="true"></xn-section-divider></li>
                    <li *ngIf="isDecicionTableMode" (click)="showSettings()">
                        <i class="fa fa-sliders mr-05" aria-hidden="true"></i>Einstellungen
                        <span class="right">(STRG + A)</span>
                    </li>
                </div>
            </ul>
        </xn-button>
    </li>
    <li class="menu">
        <xn-button (click)="menuVisible = !menuVisible"
                    (mouseenter)="openMenu('repositoryMenuVisible')"
                    [selected]="menuVisible && repositoryMenuVisible"
                    class="small transparent nounderline">Repository
            <ul *ngIf="menuVisible && repositoryMenuVisible" class="sub-menu">
                <div class="sub-menu-container">
                    <li (click)="cloneRepository()">
                        <i class="fa fa-clone mr-05" aria-hidden="true"></i>Repository Klonen
                    </li>
                    <li *ngIf="isRepositoryConnected$ | async" (click)="commitChanges()">
                        <i class="fa fa-code-fork mr-05" aria-hidden="true"></i>Änderungen commiten
                    </li>
                </div>
            </ul>
        </xn-button>
    </li>
    <li class="menu">
        <xn-button (click)="menuVisible = !menuVisible"
                   (mouseenter)="openMenu('testMenuVisible')"
                   [selected]="menuVisible && testMenuVisible"
                   class="small transparent nounderline">Tests
            <ul *ngIf="menuVisible && testMenuVisible" class="sub-menu">
                <div class="sub-menu-container">
                    <li (click)="openAllTestsDialog()">
                        <i class="fa fa-cogs mr-05" aria-hidden="true"></i>Alle ausführen
                    </li>
                </div>
            </ul>
        </xn-button>
    </li>
    <li class="menu">
        <xn-button (click)="menuVisible = !menuVisible"
                   (mouseenter)="openMenu('engineMenuVisible')"
                   [selected]="menuVisible && engineMenuVisible"
                   class="small transparent nounderline">Engine
            <ul *ngIf="menuVisible && engineMenuVisible" class="sub-menu">
                <div class="sub-menu-container">
                    <li (click)="clearDeployments()">
                        <i class="fa fa-trash-o mr-05" aria-hidden="true"></i>Deployments löschen
                    </li>
                    <li (click)="deploy()">
                        <i class="fa fa-cloud-upload mr-05" aria-hidden="true"></i>DRD bereitstellen
                    </li>
                </div>
            </ul>
        </xn-button>
    </li>
    <li class="menu">
        <xn-button (click)="menuVisible = !menuVisible"
                    (mouseenter)="openMenu('pluginMenuVisible')"
                    [selected]="menuVisible && pluginMenuVisible"
                    class="small transparent nounderline">Plugins
            <ng-container *ngIf="pluginsMerged$ | async as plugins">
                <ul *ngIf="menuVisible && pluginMenuVisible" class="sub-menu">
                    <div class="sub-menu-container">
                        <li *ngFor="let plugin of plugins" (click)="enablePlugin(plugin)">
                            <i class="fa mr-05" [ngClass]="plugin.icon" aria-hidden="true"></i>{{plugin.label}}
                            <i class="fa fa-check right" *ngIf="plugin.activated" aria-hidden="true"></i>
                        </li>
                    </div>
                </ul>
            </ng-container>
        </xn-button>
    </li>
    <li class="menu">
        <xn-button (click)="menuVisible = !menuVisible"
                    (mouseenter)="openMenu('helpMenuVisible')"
                    [selected]="menuVisible && helpMenuVisible"
                    class="small transparent nounderline">Hilfe
            <ng-container *ngIf="pluginsMerged$ | async as plugins">
                <ul *ngIf="menuVisible && helpMenuVisible" class="sub-menu">
                    <div class="sub-menu-container">
                        <li (click)="showDocumentation()">
                            <i class="fa mr-05 fa-question-circle" aria-hidden="true"></i>Dokumentation
                            <span class="right">(STRG + H)</span>
                        </li>
                    </div>
                </ul>
            </ng-container>
        </xn-button>
    </li>
</xn-menu-header>

<div class="main-content full-height">
    <as-split unit="pixel" [direction]="'horizontal'" >
        <as-split-area size="220" #area1="asSplitArea" style="display: block; overflow-y: hidden;">
            <xn-workspace (openFileRequested)="openRecentFile($event)"></xn-workspace>
        </as-split-area>
        <as-split-area size="*" #area1="asSplitArea" style="display: block; overflow-y: hidden;">
            <router-outlet></router-outlet>
        </as-split-area>
    </as-split>
</div>

<xn-dialog [closable]="true"
           [(open)]="showErrorDialog"
           (openChange)="onOpenChange($event)"
           (confirm)="clearError()"
           [hideCancelButton]="true"
           [closeOnOutsideClick]="false">
    <div class="dialog-title">
        Fehler
    </div>
    <div class="dialog-body pb-1">
        <p>
            {{filesystemError}}
        </p>
    </div>
</xn-dialog>

<xn-dialog [closable]="true"
           [open]="false"
           #unsavedChangesDialog
           [defaultOkButtonText]="'Speichern'"
           [closeOnOutsideClick]="false">
    <div class="dialog-title">
        Möchten Sie die Änderungen speichern?
    </div>
    <div class="dialog-body pb-1">
        <p>
            Einige Änderungen gehen verloren wenn sie nicht gespeichert werden.
        </p>
    </div>
    <div class="button-bar">
        <xn-button class="ml-05 mr-05" #dontSaveButton>
            Nicht speichern
        </xn-button>
    </div>
</xn-dialog>

<xn-commit-dialog #commitMessageDialog></xn-commit-dialog>

<xn-all-tests-dialog *ngIf="showAllTestsDialog" [(open)]="showAllTestsDialog"></xn-all-tests-dialog>
